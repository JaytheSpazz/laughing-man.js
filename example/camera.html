<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>laughing-man.js</title>
  <link rel="icon" type="image/png" href="./laughing-man.png">
  <style>
    html, body {
      margin: 0;
      padding: 0;
    }
  </style>
</head>
<body>
  <script src="../build/laughing-man.js"></script>
  <script>
    const $body = document.querySelector('body')

    function createLaughingManImg() {
      const $img = document.createElement('img')
      $img.src = './laughing-man-animated.svg'
      $img.style.display = 'none'
      $body.appendChild($img)

      return $img
    }

    function createVideoElement() {
      const $video = document.createElement('video')
      $video.style.maxWidth = '100vw'
      $body.appendChild($video)

      return $video
    }

    function playCameraOnVideo($video) {
      return navigator.mediaDevices.getUserMedia({ video: {
        facingMode: 'user',
        frameRate: 60,
        width: window.innerWidth,
        height: window.innerHeight
      }})
        .then(srcObject => $video.srcObject = srcObject)
        .then(() => $video.play())
    }

    //
    // Main
    //

    const $img = createLaughingManImg()
    const $video = createVideoElement()
    playCameraOnVideo($video)
      .then(() => laughingMan($video, { overlay: $img}))
  </script>
</body>
</html>
